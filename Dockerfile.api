FROM python:3.12-slim

ENV PYTHONUNBUFFERED=1

WORKDIR /app

COPY requirements-api.txt .
RUN pip install --no-cache-dir -r requirements-api.txt

COPY ./packages/aura_core /app/packages/aura_core
RUN pip install -e ./packages/aura_core

COPY aura_risk_model.joblib /app/packages/aura_core/src/aura_core/model/

COPY ./src/aura_api ./src/aura_api
COPY pyproject.toml . 

CMD ["uvicorn", "src.aura_api.main:app", "--host", "0.0.0.0", "--port", "8000"]
